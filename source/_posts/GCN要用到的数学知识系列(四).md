---
title: GCN要用到的数学知识系列(四)
date: 2019-12-17 18:55:55
mathjax: true
categories:
- GCN要用到的数学知识
tags:
- 切比雪夫微分方程
- 切比雪夫多项式
- 切比雪夫逼近
---

## **四、切比雪夫多项式**

> 切比雪夫多项式(Chebyshev polynomials)其实有很多比较不错的性质，其证明的方法也有很多，而且都很漂亮。因为GCN只是用了第一类切比雪夫多项式，以使得在计算上进一步简化，所以这里只是介绍一下第一类切比雪夫多项式，第二类的话可以用相同的方式理解，不再赘述。文章的最后也提到了一些GCN用到的相关知识。不过个人精力有限，其实还有很多有意思的性质和应用可以谈，但本文就点到为止吧。

<!--more-->

### **三角函数的多倍角公式**

高中学习三角函数中提到的最基本的二倍角公式相信大家都烂熟于心了，但是我这里还是给出(笑

$$
cos2x=2cos^2x-1
$$
不知道大家是否有时也会好奇，既然二倍角是这样呢，那三倍角如何化成关于$cosx$的多项式呢？高中知识的话，我们可以通过将$cos3x$换成$x+2x$然后用两角和公式，然后对$cosx$和$sinx$用两角和(二倍角)公式，就可以得到了$cos3x$关于$cosx$的多项式了。推导如下
$$
cos3x = cos2xcosx-sin2xsinx=(2cos^2x-1)cosx-2cosx(1-cos^2x)=4cos^3x-3cosx
$$
那么有的小伙伴自然会有新的疑问，$cosnx$呢?对于任意的$n$，$cosnx$是否都能写成关于$cosx$的多项式呢？实际上我们根据两角和公式，$cosnx$应该也是可以通过这种方式**迭代**得到的，我们接下来会去验证。那既然是迭代，我们是否可以找到关于一个$cosnx$的通项公式呢？我们进一步思考，如果要找通项公式，那我们就要列出这数列中几项之间的关系，我们下面尝试做一下，记$cosnx$关于$cosx$的多项式为$T_n(t)$，其中$t$相当于$cosx$那么显然有首项为$T_0(t)=1,T_1(t)=t$
$$
\begin{align*}
T_n(t) = & cosnt \\
=& cos(n-1)t \space cost-sin(n-1)t\space sint \\
=&cos(n-1)tcost-sint(sintcos(n-2)t-cost(t)sin(n-2)t) \\
=&cos(n-1)tcost-(1-cos^2t)cos(n-2)t-costsintsin(n-2)t \\
=&cos(n-1)tcost-cos(n-2)t+cost(costcos(n-2)t-sintsin(n-2)t) \\
=&cos(n-1)tcost-cos(n-2)t+costcos(n-1)t \\
=&2cos(n-1)tcost-cos(n-2)t \\
=&2tT_{n-1}(t)-T_{n-2}(t)
\end{align*}
$$
其实这个递推公式便是切比雪夫多项式的由来。$Perfect!~$那么问题来了，我们如何求解这个递推式子呢？如果对线性代数比较了解的同学也许觉得很easy，比如可以用矩阵迭代的方式求解，然后对于$n$次幂的矩阵使用一些矩阵的加和以及特征值分解等技巧就可以得到通解，这里我们不采用这种方案，但留在脚注中以供参考[^1]。其实除了写成递推式的形式，我们还能在$T_n(t)$本身上做文章，比如将其化为微分方程的解的形式，注意到
$$
\begin{align*}
& T_n^{'}(t) = { {d \space cosnx \over dx} \over {cosx \over dx}}= -{ nsinnx\over sinx} \\ 
& T_n^{''}(t)={ {d \space T_n^{'}(t) \over dx} \over {cosx \over dx}}=-{n^2sinxcosnx+ncosxsinnx \over sin^3x} = -{n^2cosnx - cosx \times -n {sinnx \over sinx} \over sin^2x} 
\end{align*}
$$
那么观察到$T_n^{''}(t)$式子的右侧可以用$T_n^{'}(t)$和$T_n^{''}(t)$以及$t$来表示，也就是说
$$
T_n(t)=-{n^2T_n(t)- tT_n^{'}(t) \over {1-t^2}}
$$
整理可得
$$
(1-t^2)T_n(t)- tT_n^{'}(t)+n^2T_n(t)=0
$$
那么我们如今换一个角度来看，这就变成了一个微分方程，不过这个微分方程不是常系数的，似乎也很难于求解，这里我们给出一种解法(不是最简单的，但是结果比较直观)。基于对$T_n(t)$的递推公式的思考我们可以知道，**它可以展开成关于$t$的幂函数！！！**那实际上我们就有了这么一个方案去选择，也就是假设
$$
T_n(t)=\sum_{m=0}^{\infty}a_mt^m
$$
那么代入微分方程，然后对应次幂前的系数相等，我们可以得到
$$
a_{m+2}= {(m-n)(m+n) \over (m+1)(m+2)}a_m
$$
那么我们通过对这个式子不断迭代就可以得出关于$a_m$的表达式。不过这个递推式由于间隔了一个$a_{m+1}$所以奇数项和偶数项要分开讨论。在此，我们给出其解的两个标准选择：

- $a_0=1,a_1=0$，那么有

$$
F(t)=1- {n^2 \over 2!}t^2 + {（n-2)n^2(n+2) \over 4!}t^4 - {(n-4)(n-2)n^2(n+2)(n+4) \over 6!}t^6 + \cdots
$$

- $a_0=0,a_1=1$，那么有

$$
G(t)=x- {(n-1)(n+1) \over 3!}t^3  + {(n-3)(n-1)(n+1)(n+3) \over 5!}t^5 + \cdots
$$

那么易知，**更一般的解就是这两个函数的线性组合**。对于我们这里要求解的$cosnx$来说，只需要通过代入几个$n$的展开，然后求解线性方程组，就可以得到关于对应的$F(x)$和$G(x)$的系数，这里直接给出结果。

- 当n为偶数时，那么有

$$
T_n(t)=(-1)^{n \over 2}F(t)
$$

- 当n为奇数时，那么有

$$
T_n(t)=(-1)^{(n-1) \over 2}nG(t)
$$

至此，我们通过求$cosnx$的方式首先引入切比雪夫多项式的递推公式，进而又引入了切比雪夫微分方程，并进一步求解了切比雪夫多项式，但注意到我们这里用的都是$t=cosx$，也就是限制了$t$的范围为$[-1,1]$，实际上，我们在推导过程中只是用了类比的思路，这里的$t$可以是任何值。

那么有小伙伴又要问了，你扯了这么多，这多项式有什么性质呢？GCN为啥要用它啊？

### **切比雪夫多项式的性质**

- **正交性**

  看过我前面讲述傅里叶变换的小伙伴一定对这个性质不陌生，正交性是一个非常好的性质，因为无穷多个正交函数可以做为函数空间的一组基，其实这里有正交完备性问题，但不过多展开。其实如果从$cosnx$的角度来看，我们很容易知道$T_n(t)=cosnx$，其任意两个$n$的取值所对应的的函数正交。更一般的来讲，如果是任意的$t$，那么这里是加权正交的，此处不再赘述。不理解函数正交的可以去看我[前面的文章](http://tsotfsk.top/2019/12/14/GCN要用到的数学知识系列(一)/)。

- **奇偶性**

  容易得到当$n$为偶数的时候$T_n(t)=(-1)^{n \over 2}F(t)$，而$F(t)$是一个偶函数，那么显然$T_n(t)$也是一个偶函数，同理当$n$为奇数的时候$T_n(t)=(-1)^{(n-1) \over 2}nG(t)$，而$G(t)$是一个奇函数，那么显然，此时$T_n(t)$也是一个奇函数。

- **$T_n(t)$最高次幂前系数为$2^{n-1}$**

  这个由它的递推式$T_n(t)=2tT_{n-1}(t)-T_{n-2}(t)$很容易得到，脚注中的的矩阵乘法更直观一些。
  

其余的还有一些，比如最小0逼近之类的有趣的性质，我们不在此赘述。

### **切比雪夫多项式逼近**

切比雪夫近似是利用将函数展开为由切比雪夫多项式组成的各项，依需要的逼近程度决定展开的项次，可以得到很接近多项式的结果。此作法类似进行函数的傅立叶变换，只是用切比雪夫多项式代替分析中用到的三角函数，性质中的正交性我们也可以知道其与傅里叶变换的类似性。

注意到在切比雪夫多项式中，我们用到了
$$
a_{m+2}= {(m-n)(m+n) \over (m+1)(m+2)}a_m
$$
那么根据比值判别法，当$|t|<1$的时候，这个幂级数是收敛的，也就是说如果我们对于一个定义在$[-1,1]$的函数利用切比雪夫多项式去近似，如果我们最高只用到了$a_mt^m$，也就是在$m$处截断，那么其误差其会接近$a_{m+1}t^{m+1}$的整数倍。那么其误差应该是很小的。

那么GCN为什么要用到这个呢？注意到GCN的一条核心表达式
$$
g_\theta *x=Ug_{\theta}U^Tx
$$
其中$U$是对称归一化的拉普拉斯矩阵特征向量组成的，当矩阵特别大时，求一个矩阵的特征值和特征向量的开销是很大的，而我们知道$g_{\theta}$是关于特征值$\lambda$的函数，另外注意到$L=U{\Lambda}U^T$，$L^n=U{\Lambda}^nU^T$，其中$\Lambda$是特征值组成的对角矩阵，那我们就可以通过对$g_{\theta}$做切比雪夫多项式的逼近，并在$K$处截断，以简化计算。最后作用的效果就是
$$
g_{\theta'}(\Lambda) \approx \sum_{k=0}^{K}\theta_{k}^{'}T_k(\tilde{\Lambda})
$$
因为切比雪夫展开的幂级数在$|t|<1$收敛，我们要把特征值$\lambda$放缩到这个范围，论文中采用的是$\tilde{\Lambda}={2{\Lambda} \over \lambda_{max}}-I$，很好理解，注意到对称归一化的拉普拉斯矩阵的半正定性，其特征值都是大于等于$0$的，那么显然放缩后的特征值都在$[-1,1]$内，那么
$$
g_{\theta'} *x \approx \sum_{k=0}^{K}\theta_{k}^{'}T_k(\tilde{L})x
$$
这里$\tilde{L}={2{L} \over \lambda_{max}}-I$，注意这里是一个线性变换，只改变了特征值。那么这里就省去了求特征值和特征向量的过程，GCN论文中在$K=1$处截断，只保留了$\theta_{0}^{'},\theta_{1}^{'}$，并假设了$\lambda_{max} \approx 2$。后续的话都比较好理解了。



### **结尾**

系列文章完结撒花~~第一次写博客，文笔一般，调hexo markdown插件的bug就折腾了好久，我太难了。

本系列文章除了第三篇文章大篇幅借鉴了别人的观点，其余三篇均为基于事实的个人理解。欢迎有兴趣的小伙伴进一步讨论，如有错误或者更好的理解也欢迎指正和提出。未来这几天我也许会整合这四篇文章的知识，出一个GCN综述性质的文章~先在这个挖个坑...应该会来填的！！！！

[^1]: 比如对于我们提到的切比雪夫多项式，可以得到如下矩阵迭代的形式 
$$
\begin{bmatrix}
T_n(t) \\
T_{n-1}(t) 
\end{bmatrix} = 
\begin{bmatrix}
2t &-1\\
1 &0 
\end{bmatrix}
\begin{bmatrix}
T_{n-1}(t) \\
T_{n-2}(t) 
\end{bmatrix}
$$
[^1]:那么迭代n次就有
$$
\begin{bmatrix}
T_n(t) \\
T_{n-1}(t) 
\end{bmatrix} = 
\begin{bmatrix}
2t &-1\\
0 &1 
\end{bmatrix}^{n-1}
\begin{bmatrix}
T_{1}(t) \\
T_{0}(t) 
\end{bmatrix}=\begin{bmatrix}
2t &-1\\
1 &0 
\end{bmatrix}^{n-1}\begin{bmatrix}
t \\
1
\end{bmatrix}
$$